<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>phothomac!</title>
    <!--1203 add css -->
    <link rel="stylesheet" type="text/css" href="stylesheets/style.css" />
    <script src="/socket.io/socket.io.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.7.0/fabric.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
   

  </head>
  <body>
      <!--1203 add pens start -->
      
  <div id="pens">    

      <label></label><button id="draw-mode1">Off</button>
      <label></label><button id="draw-mode2">Off</button>
      <label></label><button id="draw-mode3">Off</button>
      <label></label><button id="draw-mode4">Off</button>
      <label></label><button id="draw-mode5">Off</button>
      <label></label><button id="draw-mode6">Off</button><br />
  </div>
  


                        <!-- タブメニュー -->
                            <ul id="tab-menu">
                                <li class="active">写真スタンプ</li>
                                <li>イラストスタンプ</li>
                                <li>背景</li>
                           
                            </ul>
                            <!-- タブの中身 -->
                                <div id="tab-box">
                                    <!-- タブ1 -->
                                    <div class="active">      
                                            <span class="cut"><img src="images/sun.png" alt="image5" class="cut_image" /></span>
                                            <span class="cut"><img src="images/redsun.png" alt="image6" class="cut_image" /></span> 
                                             <% for(var i=0; i < data.length; i++){ %>
                                                    <span class="cut"><img src="images/<%= data[i].imgpath %>" alt="images" class="cut_image" /></span>
                                            <% } %>        
                                    </div>
                                    <!-- タブ2 -->
                                    <div>
                                            <span class="cut"><img src="images/pin1.png" alt="image3" class="cut_image" /></span>
                                            <span class="cut"><img src="images/pin2.png" alt="image3" class="cut_image" /></span>
                                            <span class="cut"><img src="images/pin3.png" alt="image3" class="cut_image" /></span>
                                            <span class="cut"><img src="images/becc.png" alt="image3" class="cut_image" /></span>
                                            <span class="cut"><img src="images/mbecc.png" alt="image3" class="cut_image" /></span>
                                            <span class="cut"><img src="images/pecc.png" alt="image3" class="cut_image" /></span>
                                            <span class="cut"><img src="images/wow.png" alt="image3" class="cut_image" /></span>
                                            <span class="cut"><img src="images/nice.png" alt="image7" class="cut_image" /></span>
                                            <span class="cut"><img src="images/sframe1.png" alt="image2" class="cut_image" /></span>
                                            <span class="cut"><img src="images/sframe2.png" alt="image2" class="cut_image" /></span>
                                    </div>
                                    <!-- タブ3 -->
                                    <div>      
                                    <form>
                                            <input type="radio" name="bg" value="bg1.jpg" >アーガイル
                                            <input type="radio" name="bg" value="bg2.jpg" >ステンドグラス
                                            <input type="radio" name="bg" value="bg0.jpg"checked>コルク
                                    </form>  
                                    </div>
                                    
                                </div>


  </div>

<!-- room 2016/12/11 start -->
  <div class="container">
        <h1>WebSocket-Chat</h1>
        <form class="form-inline">
            <div class="form-group">
                <label class="roomLabel" for="rooms">部屋：</label>
                <select class="form-control" id="rooms">
                    <option value="room01">部屋01</option>
                    <option value="room02">部屋02</option>
                </select>
                <label class="nameLabel" for="msgForm">名前：</label>
                <input type="text" class="form-control" id="msgForm">
            </div>
            <button type="submit" class="btn btn-primary" id="sendButton">入室</button>
        </form>
        <div id="chatLogs"></div>
    </div>
<!-- room 2016/12/11 end-->
 


     <button id="canvas2png">Canvas 2 PNG</button>
     <button id="canvasremote">Canvas remote PNG</button>

      <!--1203 end-->
      <label>ツール</label><span id="canvas-objects"></span>
      <canvas id='canvas' width='500' height='500' />
  
      <script src="javascripts/main.js"></script>
       <!--1203-->
      <script src="javascripts/pen.js"></script>
      <script src="javascripts/socket.js"></script>
                <script src="javascripts/fabric.js"></script>
                <script src="javascripts/tab.js"></script>
                <script src="javascripts/bgchange.js"></script>
                <link href="stylesheets/photobox.css" rel="stylesheet" type="text/css" />
 
<!-- room -->
  <script type="text/javascript">
        var socket = io.connect(); // C02. ソケットへの接続
        var isEnter = false;
        var name = '';
 
        // C04. server_to_clientイベント・データを受信する
        socket.on("server_to_client", function(data){appendMsg(data.value)});
        function appendMsg(text) {
            $("#chatLogs").append("<div>" + text + "</div>");
        }
 
        $("form").submit(function(e) {
            var message = $("#msgForm").val();
            var selectRoom = $("#rooms").val();
            $("#msgForm").val('');
            if (isEnter) {
              message = "[" + name + "]: " + message;
                // C03. client_to_serverイベント・データを送信する
                socket.emit("client_to_server", {value : message});
            } else {
                name = message;
                var entryMessage = name + "さんが入室しました。";
                socket.emit("client_to_server_join", {value : selectRoom});
                // C05. client_to_server_broadcastイベント・データを送信する
                socket.emit("client_to_server_broadcast", {value : entryMessage});
                // C06. client_to_server_personalイベント・データを送信する
                socket.emit("client_to_server_personal", {value : name});
                changeLabel();
            }
            e.preventDefault();
        });
 
        function changeLabel() {
            $(".nameLabel").text("メッセージ：");
            $("#rooms").prop("disabled", true);
           // $("button").text("送信");
            $("#sendButton").text("送信");
            isEnter = true;
        }
 
    </script>
<!-- room 2016/12/11 end-->
  </body>
</html>
